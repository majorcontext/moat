# Example: Claude Code agent
#
# Run Claude Code in an isolated container with credential injection.
#
# Run with:
#   moat claude examples/agent-claude
#   moat claude examples/agent-claude -p "fix the bug in main.py"

name: claude-test

dependencies:
  - node@20
  - claude-code
  - git

grants:
  - claude # Change to anthropic to use an api key
  - github
  - ssh:github.com  # For git operations (clone, push, etc.)

command: ["claude"]
interactive: true

# Claude session logs are automatically synced to the host when "anthropic" grant
# is configured. To disable, set: claude: { sync_logs: false }

# Plugin configuration
claude:
  # Enable plugins from marketplaces
  # The marketplace name in plugin@marketplace must match the repo name
  plugins:
    "claude-md-management@claude-plugins-official": true   # CLAUDE.md management
    "aws-agent-skills@aws-agent-skills": true              # AWS agent skills

  # Define custom marketplaces
  # Plugins are installed inside the container via `claude plugin marketplace add`
  # and `claude plugin install`
  # The marketplace name (key) should match the repo name for consistency
  marketplaces:
    claude-plugins-official:
      source: github
      repo: anthropics/claude-plugins-official
    aws-agent-skills:
      source: github
      repo: itsmostafa/aws-agent-skills
